<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>hddtools: Hydrological Data Discovery Tools • hddtools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="hddtools: Hydrological Data Discovery Tools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hddtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.9.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://joss.theoj.org/papers/10.21105/joss.00056" class="external-link">JOSS paper</a>
    </li>
    <li>
      <a href="http://adsabs.harvard.edu/abs/2014AGUFM.H13H1209V" class="external-link">Abstract/Poster presented at AGU 2014</a>
    </li>
    <li>
      <a href="../articles/index.html">Vignette</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropensci/hddtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>hddtools: Hydrological Data Discovery Tools</h1>
                        <h4 data-toc-skip class="author">Claudia
Vitolo</h4>
            
            <h4 data-toc-skip class="date">2024-09-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/hddtools/blob/master/vignettes/hddtools_vignette.Rmd" class="external-link"><code>vignettes/hddtools_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>hddtools_vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>hddtools</strong> stands for Hydrological Data Discovery
Tools. This R package is an open source project designed to facilitate
access to a variety of online open data sources relevant for
hydrologists and, in general, environmental scientists and
practitioners.</p>
<p>This typically implies the download of a metadata catalogue,
selection of information needed, formal request for dataset(s),
de-compression, conversion, manual filtering and parsing. All those
operation are made more efficient by re-usable functions.</p>
<p>Depending on the data license, functions can provide offline and/or
online modes. When redistribution is allowed, for instance, a copy of
the dataset is cached within the package and updated twice a year. This
is the fastest option and also allows offline use of package’s
functions. When re-distribution is not allowed, only online mode is
provided.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>Get the released version from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"hddtools"</span><span class="op">)</span></span></code></pre></div>
<p>Or the development version from github using <a href="https://github.com/r-lib/devtools" class="external-link">devtools</a>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"ropensci/hddtools"</span><span class="op">)</span></span></code></pre></div>
<p>Load the hddtools package:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://docs.ropensci.org/hddtools/" class="external-link">"hddtools"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-sources-and-functions">Data sources and Functions<a class="anchor" aria-label="anchor" href="#data-sources-and-functions"></a>
</h3>
<p>The functions provided can retrieve hydrological information from a
variety of data providers. To filter the data, it is advisable to use
the package <code>dplyr</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="the-koppen-climate-classification-map">The Koppen Climate Classification map<a class="anchor" aria-label="anchor" href="#the-koppen-climate-classification-map"></a>
</h4>
<p>The Koppen Climate Classification is the most widely used system for
classifying the world’s climates. Its categories are based on the annual
and monthly averages of temperature and precipitation. It was first
updated by Rudolf Geiger in 1961, then by Kottek et al. (2006), Peel et
al. (2007) and then by Rubel et al. (2010).</p>
<p>The package hddtools contains a function to identify the updated
Koppen-Greiger climate zone, given a bounding box.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define a bounding box</span></span>
<span><span class="va">areaBox</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">48</span>, <span class="fl">62</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract climate zones from Peel's map:</span></span>
<span><span class="fu"><a href="../reference/KGClimateClass.html">KGClimateClass</a></span><span class="op">(</span>areaBox <span class="op">=</span> <span class="va">areaBox</span>, updatedBy <span class="op">=</span> <span class="st">"Peel"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Class Frequency</span></span>
<span><span class="co">#&gt; 1  9   Csb         1</span></span>
<span><span class="co">#&gt; 2 15   Cfb      6199</span></span>
<span><span class="co">#&gt; 3 16   Cfc        10</span></span>
<span><span class="co">#&gt; 4 27   Dfc         3</span></span>
<span><span class="co">#&gt; 5 29    ET         1</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract climate zones from Kottek's map:</span></span>
<span><span class="fu"><a href="../reference/KGClimateClass.html">KGClimateClass</a></span><span class="op">(</span>areaBox <span class="op">=</span> <span class="va">areaBox</span>, updatedBy <span class="op">=</span> <span class="st">"Kottek"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Class Frequency</span></span>
<span><span class="co">#&gt; 1 32   Cfb     12301</span></span>
<span><span class="co">#&gt; 2 33   Cfc       507</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-global-runoff-data-centre">The Global Runoff Data Centre<a class="anchor" aria-label="anchor" href="#the-global-runoff-data-centre"></a>
</h4>
<p>The Global Runoff Data Centre (GRDC) is an international archive
hosted by the Federal Institute of Hydrology in Koblenz, Germany. The
Centre operates under the auspices of the World Meteorological
Organisation and retains services and datasets for all the major rivers
in the world. Catalogue, kml files and the product Long-Term Mean
Monthly Discharges are open data and accessible via the hddtools.</p>
<p>Information on all the GRDC stations can be retrieved using the
function <code>catalogueGRDC</code> with no input arguments, as in the
examle below:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># GRDC full catalogue</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueGRDC.html">catalogueGRDC</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>It is advisable to use the package <code>dplyr</code> for convenient
filtering, some examples are provided below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter GRDC catalogue based on a country code</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">country</span> <span class="op">==</span> <span class="st">"IT"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter GRDC catalogue based on rivername</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">river</span> <span class="op">==</span> <span class="st">"PO, FIUME"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter GRDC catalogue based on which daily data is available since 2000</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">d_start</span> <span class="op">&gt;=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter the catalogue based on a geographical bounding box</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, left <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, right <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lat</span>, left <span class="op">=</span> <span class="fl">48</span>, right <span class="op">=</span> <span class="fl">62</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine filtering criteria</span></span>
<span><span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, left <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, right <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lat</span>, left <span class="op">=</span> <span class="fl">48</span>, right <span class="op">=</span> <span class="fl">62</span><span class="op">)</span>,</span>
<span>         <span class="va">d_start</span> <span class="op">&gt;=</span> <span class="fl">2000</span>,</span>
<span>         <span class="va">area</span> <span class="op">&gt;</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p>The GRDC catalogue (or a subset) can be used to create a map.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualise outlets on an interactive map</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">GRDC_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">river</span> <span class="op">==</span> <span class="st">"PO, FIUME"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span><span class="op">~</span><span class="va">long</span>, <span class="op">~</span><span class="va">lat</span>, popup <span class="op">=</span> <span class="op">~</span><span class="va">station</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaflet.png"></p>
</div>
<div class="section level4">
<h4 id="top-down-modelling-working-group-data60uk-and-mopex">Top-Down modelling Working Group (Data60UK and MOPEX)<a class="anchor" aria-label="anchor" href="#top-down-modelling-working-group-data60uk-and-mopex"></a>
</h4>
<p>The Top-Down modelling Working Group (TDWG) for the Prediction in
Ungauged Basins (PUB) Decade (2003-2012) is an initiative of the
International Association of Hydrological Sciences (IAHS) which
collected datasets for hydrological modelling free-of-charge, available
<a href="http://tdwg.catchment.org/datasets.html" class="external-link">here</a>. This package
provides a common interface to retrieve, browse and filter
information.</p>
<div class="section level5">
<h5 id="the-data60uk-dataset">The Data60UK dataset<a class="anchor" aria-label="anchor" href="#the-data60uk-dataset"></a>
</h5>
<p>The Data60UK initiative collated datasets of areal precipitation and
streamflow discharge across 61 gauging sites in England and Wales (UK).
The database was prepared from source databases for research purposes,
with the intention to make it re-usable. This is now available in the
public domain free of charge.</p>
<p>The hddtools contain two functions to interact with this database:
one to retreive the catalogue and another to retreive time series of
areal precipitation and streamflow discharge.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Data60UK full catalogue</span></span>
<span><span class="va">Data60UK_catalogue_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueData60UK.html">catalogueData60UK</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter Data60UK catalogue based on bounding box</span></span>
<span><span class="va">areaBox</span> <span class="op">&lt;-</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/ext.html" class="external-link">ext</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="op">-</span><span class="fl">3</span>, <span class="fl">51</span>, <span class="fl">53</span><span class="op">)</span></span>
<span><span class="va">Data60UK_catalogue_bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueData60UK.html">catalogueData60UK</a></span><span class="op">(</span>areaBox <span class="op">=</span> <span class="va">areaBox</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualise outlets on an interactive map</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Data60UK_catalogue_bbox</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Add default OpenStreetMap map tiles</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span><span class="op">~</span><span class="va">Longitude</span>, <span class="op">~</span><span class="va">Latitude</span>, popup <span class="op">=</span> <span class="op">~</span><span class="va">Location</span><span class="op">)</span></span></code></pre></div>
<p><img src="leaflet2.png"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract time series </span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueData60UK.html">catalogueData60UK</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Extract only the time series</span></span>
<span><span class="va">MorwickTS</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsData60UK.html">tsData60UK</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="mopex">MOPEX<a class="anchor" aria-label="anchor" href="#mopex"></a>
</h5>
<p>The MOPEX dataset contains river basin characteristics and data for
hundreds of river basins from a range of climates in the US. The
catalogue can be retrieved as follows:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MOPEX full catalogue</span></span>
<span><span class="va">MOPEX_catalogue</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueMOPEX.html">catalogueMOPEX</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract data within a geographic bounding box</span></span>
<span><span class="va">MOPEX_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Longitude</span>, left <span class="op">=</span> <span class="op">-</span><span class="fl">95</span>, right <span class="op">=</span> <span class="op">-</span><span class="fl">92</span><span class="op">)</span>,</span>
<span>         <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/between.html" class="external-link">between</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Latitude</span>, left <span class="op">=</span> <span class="fl">37</span>, right <span class="op">=</span> <span class="fl">41</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get stations with recondings in the period 1st Jan to 31st Dec 1995</span></span>
<span><span class="va">MOPEX_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Date_start</span> <span class="op">&lt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1995-01-01"</span><span class="op">)</span>,</span>
<span>         <span class="va">Date_end</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1995-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get only catchments within NC</span></span>
<span><span class="va">MOPEX_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">State</span> <span class="op">==</span> <span class="st">"NC"</span><span class="op">)</span></span></code></pre></div>
<p>For each station, historical hydrometeorological data can also be
retrieved.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take the first record in the catalogue</span></span>
<span><span class="va">river_metadata</span> <span class="op">&lt;-</span> <span class="va">MOPEX_catalogue</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Get corresponding time series</span></span>
<span><span class="va">river_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsMOPEX.html">tsMOPEX</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">river_metadata</span><span class="op">$</span><span class="va">USGS_ID</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract data between 1st Jan and 31st December 1948</span></span>
<span><span class="va">river_ts_shorter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/window.html" class="external-link">window</a></span><span class="op">(</span><span class="va">river_ts</span>,</span>
<span>                           start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1948-01-01"</span><span class="op">)</span>,</span>
<span>                           end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1948-12-31"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">river_ts_shorter</span>,</span>
<span>     main <span class="op">=</span> <span class="va">river_metadata</span><span class="op">$</span><span class="va">Name</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P [mm/day]"</span>,<span class="st">"E [mm/day]"</span>, <span class="st">"Q [mm/day]"</span>, <span class="st">"Tmax [C]"</span>,<span class="st">"Tmin [C]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mopex.png"></p>
</div>
</div>
<div class="section level4">
<h4 id="sepa-river-level-data">SEPA river level data<a class="anchor" aria-label="anchor" href="#sepa-river-level-data"></a>
</h4>
<p>The Scottish Environment Protection Agency (SEPA) manages river level
data for hundreds of gauging stations in the UK. The catalogue of
stations is derived from the list here: <a href="https://www2.sepa.org.uk/waterlevels/CSVs/SEPA_River_Levels_Web.csv" class="external-link uri">https://www2.sepa.org.uk/waterlevels/CSVs/SEPA_River_Levels_Web.csv</a>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># SEPA catalogue</span></span>
<span><span class="va">SEPA_catalogue</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/catalogueSEPA.html">catalogueSEPA</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The time series of the last few days is available from SEPA website
and can be downloaded using the following function:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take the first record in the catalogue</span></span>
<span><span class="va">Perth_metadata</span> <span class="op">&lt;-</span> <span class="va">SEPA_catalogue</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co"># Single time series extraction</span></span>
<span><span class="va">Perth_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsSEPA.html">tsSEPA</a></span><span class="op">(</span>id <span class="op">=</span> <span class="va">Perth_metadata</span><span class="op">$</span><span class="va">LOCATION_CODE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Perth_ts</span>,</span>
<span>     main <span class="op">=</span> <span class="va">Perth_metadata</span><span class="op">$</span><span class="va">STATION_NAME</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Water level [m]"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get only catchments with area above 4000 Km2</span></span>
<span><span class="va">SEPA_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">CATCHMENT_AREA</span> <span class="op">&gt;=</span> <span class="fl">4000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get only catchments within river Ayr</span></span>
<span><span class="va">SEPA_catalogue</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">RIVER_NAME</span> <span class="op">==</span> <span class="st">"Ayr"</span><span class="op">)</span></span></code></pre></div>
<p>Plese note that these data are updated every 15 minutes and the code
will always generate different plots.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple time series extraction</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tsSEPA.html">tsSEPA</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"234253"</span>, <span class="st">"234174"</span>, <span class="st">"234305"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">y</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Water level [m]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Claudia Vitolo, Dorothea Hug Peter.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
